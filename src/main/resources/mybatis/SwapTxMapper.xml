<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ether.data.dao.SwapTxMapper">
    <resultMap id="BaseResultMap" type="com.ether.data.entity.SwapTx">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri May 10 11:31:21 CST 2024.
        -->
        <id column="pair_address" jdbcType="VARCHAR" property="pairAddress"/>
        <id column="block_number" jdbcType="DECIMAL" property="blockNumber"/>
        <id column="transaction_hash" jdbcType="VARCHAR" property="transactionHash"/>
        <id column="index" jdbcType="INTEGER" property="index"/>
        <result column="amount0_in" jdbcType="DECIMAL" property="amount0In"/>
        <result column="amount1_out" jdbcType="DECIMAL" property="amount1Out"/>
        <result column="amount1_in" jdbcType="DECIMAL" property="amount1In"/>
        <result column="amount0_out" jdbcType="DECIMAL" property="amount0Out"/>
        <result column="rate01" jdbcType="DECIMAL" property="rate01"/>
        <result column="rate10" jdbcType="DECIMAL" property="rate10"/>
        <result column="sender" jdbcType="VARCHAR" property="sender"/>
        <result column="receiver" jdbcType="VARCHAR" property="receiver"/>
        <result column="token0_symbol" jdbcType="VARCHAR" property="token0Symbol"/>
        <result column="token1_symbol" jdbcType="VARCHAR" property="token1Symbol"/>
        <result column="time" jdbcType="TIMESTAMP" property="time"/>
    </resultMap>
    <sql id="Base_Column_List">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri May 10 11:31:21 CST 2024.
        -->
        pair_address, block_number, transaction_hash, index, amount0_in, amount1_out, amount1_in,
        amount0_out, rate01, rate10, sender, receiver, token0_symbol, token1_symbol, time
    </sql>
    <select id="selectByPrimaryKey" parameterType="com.ether.data.entity.SwapTxKey" resultMap="BaseResultMap">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri May 10 11:31:21 CST 2024.
        -->
        select
        <include refid="Base_Column_List"/>
        from swap_tx
        where pair_address = #{pairAddress,jdbcType=VARCHAR}
        and block_number = #{blockNumber,jdbcType=DECIMAL}
        and transaction_hash = #{transactionHash,jdbcType=VARCHAR}
        and index = #{index,jdbcType=INTEGER}
    </select>
    <delete id="deleteByPrimaryKey" parameterType="com.ether.data.entity.SwapTxKey">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri May 10 11:31:21 CST 2024.
        -->
        delete from swap_tx
        where pair_address = #{pairAddress,jdbcType=VARCHAR}
        and block_number = #{blockNumber,jdbcType=DECIMAL}
        and transaction_hash = #{transactionHash,jdbcType=VARCHAR}
        and index = #{index,jdbcType=INTEGER}
    </delete>
    <insert id="insert" parameterType="com.ether.data.entity.SwapTx">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri May 10 11:31:21 CST 2024.
        -->
        insert into swap_tx (pair_address, block_number, transaction_hash,
        index, amount0_in, amount1_out,
        amount1_in, amount0_out, rate01,
        rate10, sender, receiver,
        token0_symbol, token1_symbol, time
        )
        values (#{pairAddress,jdbcType=VARCHAR}, #{blockNumber,jdbcType=DECIMAL}, #{transactionHash,jdbcType=VARCHAR},
        #{index,jdbcType=INTEGER}, #{amount0In,jdbcType=DECIMAL}, #{amount1Out,jdbcType=DECIMAL},
        #{amount1In,jdbcType=DECIMAL}, #{amount0Out,jdbcType=DECIMAL}, #{rate01,jdbcType=DECIMAL},
        #{rate10,jdbcType=DECIMAL}, #{sender,jdbcType=VARCHAR}, #{receiver,jdbcType=VARCHAR},
        #{token0Symbol,jdbcType=VARCHAR}, #{token1Symbol,jdbcType=VARCHAR}, #{time,jdbcType=TIMESTAMP}
        )
    </insert>
    <insert id="insertSelective" parameterType="com.ether.data.entity.SwapTx">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri May 10 11:31:21 CST 2024.
        -->
        insert into swap_tx
        <trim prefix="(" suffix=")" suffixOverrides=",">
            <if test="pairAddress != null">
                pair_address,
            </if>
            <if test="blockNumber != null">
                block_number,
            </if>
            <if test="transactionHash != null">
                transaction_hash,
            </if>
            <if test="index != null">
                index,
            </if>
            <if test="amount0In != null">
                amount0_in,
            </if>
            <if test="amount1Out != null">
                amount1_out,
            </if>
            <if test="amount1In != null">
                amount1_in,
            </if>
            <if test="amount0Out != null">
                amount0_out,
            </if>
            <if test="rate01 != null">
                rate01,
            </if>
            <if test="rate10 != null">
                rate10,
            </if>
            <if test="sender != null">
                sender,
            </if>
            <if test="receiver != null">
                receiver,
            </if>
            <if test="token0Symbol != null">
                token0_symbol,
            </if>
            <if test="token1Symbol != null">
                token1_symbol,
            </if>
            <if test="time != null">
                time,
            </if>
        </trim>
        <trim prefix="values (" suffix=")" suffixOverrides=",">
            <if test="pairAddress != null">
                #{pairAddress,jdbcType=VARCHAR},
            </if>
            <if test="blockNumber != null">
                #{blockNumber,jdbcType=DECIMAL},
            </if>
            <if test="transactionHash != null">
                #{transactionHash,jdbcType=VARCHAR},
            </if>
            <if test="index != null">
                #{index,jdbcType=INTEGER},
            </if>
            <if test="amount0In != null">
                #{amount0In,jdbcType=DECIMAL},
            </if>
            <if test="amount1Out != null">
                #{amount1Out,jdbcType=DECIMAL},
            </if>
            <if test="amount1In != null">
                #{amount1In,jdbcType=DECIMAL},
            </if>
            <if test="amount0Out != null">
                #{amount0Out,jdbcType=DECIMAL},
            </if>
            <if test="rate01 != null">
                #{rate01,jdbcType=DECIMAL},
            </if>
            <if test="rate10 != null">
                #{rate10,jdbcType=DECIMAL},
            </if>
            <if test="sender != null">
                #{sender,jdbcType=VARCHAR},
            </if>
            <if test="receiver != null">
                #{receiver,jdbcType=VARCHAR},
            </if>
            <if test="token0Symbol != null">
                #{token0Symbol,jdbcType=VARCHAR},
            </if>
            <if test="token1Symbol != null">
                #{token1Symbol,jdbcType=VARCHAR},
            </if>
            <if test="time != null">
                #{time,jdbcType=TIMESTAMP},
            </if>
        </trim>
    </insert>
    <update id="updateByPrimaryKeySelective" parameterType="com.ether.data.entity.SwapTx">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri May 10 11:31:21 CST 2024.
        -->
        update swap_tx
        <set>
            <if test="amount0In != null">
                amount0_in = #{amount0In,jdbcType=DECIMAL},
            </if>
            <if test="amount1Out != null">
                amount1_out = #{amount1Out,jdbcType=DECIMAL},
            </if>
            <if test="amount1In != null">
                amount1_in = #{amount1In,jdbcType=DECIMAL},
            </if>
            <if test="amount0Out != null">
                amount0_out = #{amount0Out,jdbcType=DECIMAL},
            </if>
            <if test="rate01 != null">
                rate01 = #{rate01,jdbcType=DECIMAL},
            </if>
            <if test="rate10 != null">
                rate10 = #{rate10,jdbcType=DECIMAL},
            </if>
            <if test="sender != null">
                sender = #{sender,jdbcType=VARCHAR},
            </if>
            <if test="receiver != null">
                receiver = #{receiver,jdbcType=VARCHAR},
            </if>
            <if test="token0Symbol != null">
                token0_symbol = #{token0Symbol,jdbcType=VARCHAR},
            </if>
            <if test="token1Symbol != null">
                token1_symbol = #{token1Symbol,jdbcType=VARCHAR},
            </if>
            <if test="time != null">
                time = #{time,jdbcType=TIMESTAMP},
            </if>
        </set>
        where pair_address = #{pairAddress,jdbcType=VARCHAR}
        and block_number = #{blockNumber,jdbcType=DECIMAL}
        and transaction_hash = #{transactionHash,jdbcType=VARCHAR}
        and index = #{index,jdbcType=INTEGER}
    </update>
    <update id="updateByPrimaryKey" parameterType="com.ether.data.entity.SwapTx">
        <!--
          WARNING - @mbg.generated
          This element is automatically generated by MyBatis Generator, do not modify.
          This element was generated on Fri May 10 11:31:21 CST 2024.
        -->
        update swap_tx
        set amount0_in = #{amount0In,jdbcType=DECIMAL},
        amount1_out = #{amount1Out,jdbcType=DECIMAL},
        amount1_in = #{amount1In,jdbcType=DECIMAL},
        amount0_out = #{amount0Out,jdbcType=DECIMAL},
        rate01 = #{rate01,jdbcType=DECIMAL},
        rate10 = #{rate10,jdbcType=DECIMAL},
        sender = #{sender,jdbcType=VARCHAR},
        receiver = #{receiver,jdbcType=VARCHAR},
        token0_symbol = #{token0Symbol,jdbcType=VARCHAR},
        token1_symbol = #{token1Symbol,jdbcType=VARCHAR},
        time = #{time,jdbcType=TIMESTAMP}
        where pair_address = #{pairAddress,jdbcType=VARCHAR}
        and block_number = #{blockNumber,jdbcType=DECIMAL}
        and transaction_hash = #{transactionHash,jdbcType=VARCHAR}
        and index = #{index,jdbcType=INTEGER}
    </update>

    <select id="getPairPrice" parameterType="java.lang.String" resultType="java.util.Map">
        SELECT min(rate01) as `min`,max(rate01) as `max`,
        (SELECT	B.rate01 FROM swap_tx B WHERE B.time = min( A.time )) AS 'first',
        (SELECT B.rate01 FROM swap_tx B WHERE B.time = max( A.time )) AS 'last',
        <if test="type != null and type == 1">
            DATE_FORMAT(time, '%Y-%m-%d %H:%i:%s') as `time`
        </if>
        <if test="type != null and type == 2">
            DATE_FORMAT(time, '%Y-%m-%d %H:%i') as `time`
        </if>
        <if test="type != null and type == 3">
            DATE_FORMAT(time, '%Y-%m-%d %H') as `time`
        </if>
        <if test="type != null and type == 4">
            DATE_FORMAT(time, '%Y-%m-%d') as `time`
        </if>
        <if test="type != null and type == 5">
            DATE_FORMAT(time, '%Y-%m') as `time`
        </if>
        FROM `swap_tx` A
        WHERE A.pair_address = #{pairAddress,jdbcType=VARCHAR}
        <if test="type != null and type == 1">
            GROUP BY DATE_FORMAT(time, '%Y-%m-%d %H:%i:%s')
        </if>
        <if test="type != null and type == 2">
            GROUP BY DATE_FORMAT(time, '%Y-%m-%d %H:%i')
        </if>
        <if test="type != null and type == 3">
            GROUP BY DATE_FORMAT(time, '%Y-%m-%d %H')
        </if>
        <if test="type != null and type == 4">
            GROUP BY DATE_FORMAT(time, '%Y-%m-%d')
        </if>
        <if test="type != null and type == 5">
            GROUP BY DATE_FORMAT(time, '%Y-%m')
        </if>
        ORDER BY A.`time` DESC
    </select>
</mapper>